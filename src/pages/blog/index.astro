---
import Layout from '../../components/Layout/Layout.astro';
import BlogPostCard from '../../components/BlogPostCard.astro';
import Pagination from '../../components/Pagination.astro';
import TagList from '../../components/TagList.astro';

import { getMergedPosts } from '../../utils/posts';

const POSTS_PER_PAGE = 10;

const posts = await getMergedPosts();
const totalPages = Math.ceil(posts.length / POSTS_PER_PAGE);

const currentPage = 1;
const paginatedPosts = posts.slice(0, POSTS_PER_PAGE);
---

<Layout title="Blog" description="ブログ一覧">
    <section class="py-4">
        <TagList posts={posts} />

        <h2 class="text-3xl font-bold mb-4">
            記事一覧（ページ {currentPage} / {totalPages}）
        </h2>

        <ul class="grid grid-cols-1 md:grid-cols-2 gap-4">
            {paginatedPosts.map(post => (
                <BlogPostCard post={post} />
            ))}
        </ul>

        <Pagination
            currentPage={currentPage}
            totalPages={totalPages}
            basePath="/blog"
        />
    </section>
</Layout>
